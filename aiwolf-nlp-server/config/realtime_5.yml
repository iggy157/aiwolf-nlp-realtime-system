# リアルタイム（グループチャット方式）設定ファイル
# https://github.com/aiwolfdial/aiwolf-nlp-server/blob/main/doc/ja/config.md

server:
  web_socket:
    host: 127.0.0.1
    port: 8080
  manual_start: true
  authentication:
    enable: false
  timeout:
    action: 60s
    response: 120s
    acceptable: 5s
  max_continue_error_ratio: 0.2

game:
  agent_count: 5
  max_day: -1
  vote_visibility: false
  talk:
    max_count:
      per_agent: 10        # リアルタイムモードでは1日あたりの最大発言回数
      per_day: 50
    max_length:
      count_in_word: false
      count_spaces: false
      per_talk: 200         # 1回の発言あたりの最大文字数
      mention_length: 50
      per_agent: -1
      base_length: 50
    max_skip: 0
  whisper:
    max_count:
      per_agent: 0
      per_day: 0
    max_length:
      count_in_word: false
      count_spaces: false
      per_talk: -1
      mention_length: 50
      per_agent: -1
      base_length: 50
    max_skip: 0
  # リアルタイム通信設定
  realtime:
    enable: true
    phase_timeout: 120s     # トークフェーズ全体の制限時間
    silence_timeout: 15s    # 全員が沈黙した場合のタイムアウト
    rate_limit: 2s          # 1エージェントの最小発言間隔（スパム防止）
  vote:
    max_count: 1
    allow_self_vote: true
  attack_vote:
    max_count: 1
    allow_self_vote: true
    allow_no_target: false

logic:
  day_phases:
    - name: "morning_whisper"
      actions: ["whisper"]
      only_day: 0
    - name: "daily_talk"
      actions: ["talk"]
  night_phases:
    - name: "evening_whisper"
      actions: ["whisper"]
      only_day: 0
    - name: "execution"
      actions: ["execution"]
      except_day: 0
    - name: "divine"
      actions: ["divine"]
    - name: "night_whisper"
      actions: ["whisper"]
      except_day: 0
    - name: "guard"
      actions: ["guard"]
      except_day: 0
    - name: "attack"
      actions: ["attack"]
      except_day: 0
  roles:
    5:
      WEREWOLF: 1
      POSSESSED: 1
      SEER: 1
      VILLAGER: 2

matching:
  self_match: true
  is_optimize: false
  team_count: 0
  game_count: 1
  output_path: ""
  infinite_loop: false

custom_profile:
  enable: false

json_logger:
  enable: false

game_logger:
  enable: true
  output_dir: "./log"
  filename: "game_{id}.log"

realtime_broadcaster:
  enable: false

tts_broadcaster:
  enable: false

# ビューアからエージェントプロセスを起動/停止する機能
agent_spawner:
  enable: true
  agent_dir: ../aiwolf-nlp-agent-llm
  python_cmd: uv run python
  config_template: config/config.realtime.yml.example